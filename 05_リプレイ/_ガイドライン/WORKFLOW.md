# 協働型マルチエージェントワークフロー - リプレイ小説作成

**作成日:** 2026-01-01
**目的:** プロジェクトオーナー、原作者エージェント、編集者エージェント、校正エージェントの協働により、読み物としての面白さと正確性を両立した高品質なリプレイ小説を作成する

---

## 🎯 ワークフローの全体像

```
セッション実施
    ↓
【Phase 0】素材準備（プロジェクトオーナー）
    ├─ 時系列メモ作成
    ├─ セリフ自動抽出
    └─ セリフ校正・ユーザー確認
    ↓
【Phase 1】構成設計（原作者 ↔ 編集者）
    ├─ 原作者: 構成案作成
    ├─ 編集者: 構成レビュー
    └─ 原作者: 構成最終調整
    ↓
【Phase 2】初稿執筆（原作者）
    └─ 構成に基づき初稿作成
    ↓
【Phase 3】編集レビュー（編集者 ↔ 原作者）
    ├─ 編集者: 読み物クオリティチェック
    ├─ 原作者: 編集指摘への対応
    └─ ※品質基準未達の場合はPhase 2へ戻る
    ↓
【Phase 4】校正レビュー（校正者 ↔ 原作者）
    ├─ 校正者: 文章の正確性チェック
    ├─ 原作者: 校正指摘への対応
    └─ ※品質基準未達の場合はPhase 2へ戻る
    ↓
【Phase 5】事実確認（検証エージェント ↔ 原作者）
    ├─ 検証エージェント: 一次データとの照合
    ├─ 原作者: 事実誤認の修正
    └─ ※矛盾が多い場合はPhase 2へ戻る
    ↓
【Phase 6】ユーザー最終確認
    └─ プロジェクトオーナーによる承認
    ↓
【Phase 7】キャラクター評価更新
    └─ キャラ評エージェント: PCおよびNPC評価を更新
    ↓
【Phase 8】完成・公開
    └─ GitコミットおよびWebサイトへの反映
    ↓
【Meta-Review】複数回振り返り（3話ごと or 重要分岐点）
    ├─ 全エージェント参加
    ├─ 伏線の一貫性チェック
    ├─ キャラクター描写の一貫性チェック
    └─ ガイドラインのアップデート
```

---

## 👥 エージェントの役割定義

### プロジェクトオーナー（ユーザー）
- **役割:** 一次データ提供、時系列メモ作成、最終承認
- **責任範囲:** 事実関係の正確性の担保
- **使用ツール:** 手作業、Claude

### 原作者エージェント（Author Agent）
- **役割:** リプレイ小説の執筆、構成設計、編集・校正指摘への対応
- **責任範囲:** ストーリーテリング、キャラクター描写、臨場感の創出
- **推奨モデル:** Sonnet（高度な創作能力が必要）
- **参照ガイドライン:**
  - リプレイテンプレート.md
  - 文体統一ガイドライン.md
  - セリフ洗練化ガイドライン.md

### 編集者エージェント（Editor Agent）
- **役割:** 読み物としてのクオリティチェック、構成レビュー、改善提案
- **責任範囲:**
  - Show vs Tellのバランス
  - テンポ・リズム
  - 冗長性の排除
  - クリフハンガーの効果
- **推奨モデル:** Sonnet（高度な編集判断が必要）
- **参照ガイドライン:** 編集ガイドライン.md

### 校正者エージェント（Proofreader Agent）
- **役割:** 文章の正確性チェック、表記統一、誤字脱字の発見
- **責任範囲:**
  - 文法エラー
  - 句読点の適切性
  - 表現のゆらぎ
  - 漢字・ひらがなのバランス
- **推奨モデル:** Haiku（ルールベースで高速・低コスト）
- **参照ガイドライン:** 校正ガイドライン.md

### 検証エージェント（Verification Agent）
- **役割:** 一次データとの事実照合、時系列チェック
- **責任範囲:** 事実誤認の発見と指摘
- **推奨モデル:** Haiku（データ照合はルールベース）
- **参照ファイル:** 04_プレイヤーログ/、07_セッション音声ログ/

### キャラ評エージェント（Character Analysis Agent）
- **役割:** キャラクター評価の更新、関係性の分析
- **責任範囲:** PCおよびNPCの成長・変化の記録
- **推奨モデル:** Sonnet（キャラクター分析は高度な理解が必要）
- **参照ファイル:** 08_LLMによるキャラ評/

---

## 📥 Phase 0: 素材準備（プロジェクトオーナー）

### 目的
原作者エージェントが執筆に専念できるよう、必要な素材を整理・提供する

### 0-1. 一次データの配置

**配置先:**
```
04_プレイヤーログ/
├── 巡礼者_PLチョモラン/第X回目.txt
├── ノクシル_PLたつや/第X回目.txt（あれば）
└── シャルル_PLまけいぬ/第X回目_シャルル日誌.txt（あれば）

07_セッション音声ログ/第X回目-*.srt
```

**チェックリスト:**
- [ ] 巡礼者ログを配置
- [ ] ノクシルログを配置（あれば）
- [ ] シャルル日誌を配置（あれば）
- [ ] 音声ログを配置
- [ ] ファイル名が統一形式か確認

### 0-2. 時系列メモの作成（Aレベル = 粗筋レベル）

**目的:** 原作者エージェントがストーリーの流れを把握しやすくする

**Claudeへの推奨プロンプト:**
```
第X回のプレイヤーログから、粗筋レベルの時系列メモを作成してください。

【参照ファイル】
- 04_プレイヤーログ/巡礼者_PLチョモラン/第X回目.txt
- 04_プレイヤーログ/シャルル_PLまけいぬ/第X回目_シャルル日誌.txt（あれば）
- 04_プレイヤーログ/ノクシル_PLたつや/第X回目.txt（あれば）

【出力形式】
- 時系列順に箇条書き
- 各イベントは1-2行で簡潔に
- 重要な判定結果や分岐点を明記
- 登場NPCをリスト化

【出力先】
04_プレイヤーログ/_時系列メモ/第X回_時系列メモ.md
```

**Aレベル時系列メモの例:**
```markdown
# 第X回 時系列メモ

## 冒頭
- 前回の続き、休憩所で合流
- シマが新たに加わる

## 墓地への移動
- センサ船長から情報を得る
- ファルジーン市の墓地へ向かう

## 墓地での調査
- 墓荒らしの痕跡を発見
- 死体泥棒と遭遇、戦闘（巡礼者が《シャター》でドアを破壊）
- 地下通路を発見

## クリフハンガー
- 地下通路の奥に謎の光が見える
- 次回へ続く

## 登場NPC
- センサ船長（情報提供）
- シマ（新規参加）
- 死体泥棒（戦闘）
```

**チェックリスト:**
- [ ] 時系列が正確
- [ ] 重要な分岐点が記録されている
- [ ] 登場NPCがリスト化されている
- [ ] 次回への伏線が明記されている

### 0-3. セリフ自動抽出 → 自動校正 → ユーザー確認

**ステップ1: セリフ自動抽出**

**Claudeへの推奨プロンプト:**
```
第X回の音声ログから、特徴的なセリフを自動抽出してください。

【参照ファイル】
07_セッション音声ログ/第X回目-*.srt

【抽出基準】
- キャラクターの個性が表れているセリフ
- ストーリー上重要な会話
- 感情が表れているセリフ
- 雑談は除外

【出力形式】
キャラクター名: 「セリフ」（タイムスタンプ）

【出力先】
07_セッション音声ログ/_抽出セリフ/第X回_セリフ抽出_RAW.md
```

**ステップ2: セリフ自動校正**

**Claudeへの推奨プロンプト:**
```
抽出したセリフを、セリフ洗練化ガイドライン.mdに基づいて自動校正してください。

【参照ファイル】
- 07_セッション音声ログ/_抽出セリフ/第X回_セリフ抽出_RAW.md
- 05_リプレイ/_ガイドライン/セリフ洗練化ガイドライン.md

【校正内容】
- 自動文字起こしの誤変換を修正
- 不要なフィラーを削除
- キャラクターの口調に合わせて微調整

【出力先】
07_セッション音声ログ/_抽出セリフ/第X回_セリフ校正済み.md
```

**ステップ3: ユーザー確認**

プロジェクトオーナーが `第X回_セリフ校正済み.md` をレビュー

**チェックリスト:**
- [ ] キャラクターの発言として正確か
- [ ] 誤変換が残っていないか
- [ ] 文脈が正しく反映されているか
- [ ] 必要に応じて手動修正

**完了後:**
```
07_セッション音声ログ/_抽出セリフ/第X回_セリフ確定版.md
```
を作成してPhase 1へ

---

## 📐 Phase 1: 構成設計（原作者 ↔ 編集者）

### 目的
リプレイ小説の全体構成を設計し、編集者のレビューを受けて最適化する

### 1-1. 原作者による構成案作成

**使用エージェント:** Plan Agent（原作者エージェント）

**Claudeへの推奨プロンプト:**
```
第X回のリプレイ小説の構成案を作成してください。

【参照ファイル】
1. 04_プレイヤーログ/_時系列メモ/第X回_時系列メモ.md
2. 07_セッション音声ログ/_抽出セリフ/第X回_セリフ確定版.md
3. 05_リプレイ/_ガイドライン/リプレイテンプレート.md
4. 05_リプレイ/第(X-1)回_*.md（前回のリプレイ）

【出力内容】
- 章立て（シーン分割）
- 各章の概要（3-5行）
- 重点的に描写すべきシーン
- 使用するセリフの候補
- 前回からの伏線の処理方法
- 次回への伏線の仕込み方

【出力先】
05_リプレイ/_構成案/第X回_構成案_v1.md
```

**構成案の例:**
```markdown
# 第X回 構成案 v1

## 第1章: 墓地への旅立ち
**概要:** センサ船長から墓荒らしの情報を得て、墓地へ向かう決意をする
**重点描写:** シャルルの正義感、ノクシルの冷静な分析
**使用セリフ:**
- センサ: 「墓が荒らされているんだ。死者への冒涜だ」
- シャルル: 「見過ごすわけにはいかない！」
**伏線処理:** 前回の拘置所での騒動の後日談を簡潔に触れる

## 第2章: 墓地での発見
**概要:** 墓地に到着し、墓荒らしの痕跡を調査する
**重点描写:** 緊張感のある調査シーン、PCたちの協力
**使用セリフ:**
- 巡礼者: 「この土は最近掘り返されている」
- ノクシル: 「問題ない、追跡できる」

## 第3章: 死体泥棒との遭遇
**概要:** 死体泥棒と遭遇し、戦闘になる
**重点描写:** 巡礼者の《シャター》による迫力ある戦闘
**使用セリフ:**
- 巡礼者: 「我が信仰の力、見よ！」

## 第4章: 地下への扉
**概要:** 戦闘後、地下通路を発見する
**重点描写:** 不穏な雰囲気、次回への期待感
**伏線仕込み:** 地下通路の奥に謎の光 → 次回へ
```

**チェックリスト:**
- [ ] 時系列メモに基づいている
- [ ] リプレイテンプレートに準拠している
- [ ] 前回からの伏線が処理されている
- [ ] 次回への伏線が仕込まれている
- [ ] セリフ確定版から適切なセリフを選定している

### 1-2. 編集者による構成レビュー

**使用エージェント:** Editor Agent（編集者エージェント）

**Claudeへの推奨プロンプト:**
```
原作者が作成した構成案を、編集者の視点でレビューしてください。

【参照ファイル】
- 05_リプレイ/_構成案/第X回_構成案_v1.md
- 05_リプレイ/_ガイドライン/編集ガイドライン.md

【レビュー観点】
1. テンポ・リズム: 章のバランスは適切か
2. Show vs Tell: 描写シーンと説明シーンのバランス
3. クリフハンガー: 次回への引きは効果的か
4. 冗長性: 不要な章や重複がないか
5. 読者の感情誘導: 盛り上がりと緩急のメリハリ

【出力形式】
- 各章への具体的なフィードバック
- 改善提案（代案を含む）
- 総合評価（A/B/C）

【出力先】
05_リプレイ/_構成案/第X回_編集レビュー_v1.md
```

**編集レビューの例:**
```markdown
# 第X回 編集レビュー v1

## 第1章へのフィードバック
**評価:** B
**指摘:**
- センサ船長からの情報提供シーンが長すぎる可能性
- シャルルの正義感は良いが、もう少し具体的な動機があると良い

**改善提案:**
- センサ船長のセリフを簡潔にして、すぐに墓地へ向かう展開に
- シャルルが過去の経験（ルンジャタ）と重ねて反応する描写を追加

## 第2章へのフィードバック
**評価:** A
**指摘:** 良好。緊張感のある調査シーンとして機能している

## 第3章へのフィードバック
**評価:** B
**指摘:**
- 戦闘シーンが短すぎる可能性
- 巡礼者の《シャター》だけでなく、他のPCの活躍も描写すべき

**改善提案:**
- ノクシルの遠距離攻撃、シャルルの支援を追加
- 戦闘の緊迫感を高めるために、死体泥棒の不気味さを強調

## 第4章へのフィードバック
**評価:** A
**指摘:** クリフハンガーとして効果的

## 総合評価: B+
**総評:** 全体的に良い構成だが、第1章と第3章に改善の余地あり。
テンポを重視するなら第1章を短縮、戦闘の迫力を重視するなら第3章を拡充すべき。
```

**品質ゲート:**
- **合格基準:** 総合評価がB以上、かつ重大な構成上の問題がない
- **不合格の場合:** 原作者がフィードバックを受けて構成案を修正（v2作成）

### 1-3. 原作者による構成最終調整

**使用エージェント:** Author Agent（原作者エージェント）

**Claudeへの推奨プロンプト:**
```
編集者のフィードバックを受けて、構成案を最終調整してください。

【参照ファイル】
- 05_リプレイ/_構成案/第X回_構成案_v1.md
- 05_リプレイ/_構成案/第X回_編集レビュー_v1.md

【調整内容】
- 編集者の改善提案を反映
- 代案がある場合は採用可否を判断
- 最終的な構成を確定

【出力先】
05_リプレイ/_構成案/第X回_構成案_確定版.md
```

**チェックリスト:**
- [ ] 編集者の指摘に対応している
- [ ] 改善提案を反映している
- [ ] 構成として完成度が高い
- [ ] Phase 2の執筆に進める状態

---

## ✍️ Phase 2: 初稿執筆（原作者）

### 目的
確定した構成案に基づき、リプレイ小説の初稿を執筆する

### 2-1. 初稿執筆

**使用エージェント:** Author Agent（原作者エージェント）

**Claudeへの推奨プロンプト:**
```
第X回のリプレイ小説の初稿を執筆してください。

【必須条件】
- 一次データ（プレイヤーログ）を最優先で参照
- 構成案_確定版に基づいて執筆
- セリフ確定版から適切なセリフを使用
- 事実と創作を明確に区別（創作は最小限に）

【参照ファイル】
1. 05_リプレイ/_構成案/第X回_構成案_確定版.md
2. 04_プレイヤーログ/巡礼者_PLチョモラン/第X回目.txt
3. 04_プレイヤーログ/シャルル_PLまけいぬ/第X回目_シャルル日誌.txt（あれば）
4. 04_プレイヤーログ/ノクシル_PLたつや/第X回目.txt（あれば）
5. 07_セッション音声ログ/_抽出セリフ/第X回_セリフ確定版.md
6. 05_リプレイ/_ガイドライン/リプレイテンプレート.md
7. 05_リプレイ/_ガイドライン/文体統一ガイドライン.md
8. 05_リプレイ/_ガイドライン/セリフ洗練化ガイドライン.md

【出力先】
05_リプレイ/第X回_（タイトル）_初稿.md
```

**初稿執筆時の注意点:**

1. **文体統一ガイドライン準拠**
   - 地の文は「である調」
   - 主語を明確に
   - 短文・長文のバランス

2. **セリフ洗練化ガイドライン準拠**
   - キャラクターの口調・個性を反映
   - セリフ確定版を活用
   - 必要に応じて微調整

3. **事実と創作の境界**
   - プレイヤーログにない出来事は創作しない
   - 内面描写はPLログに基づく
   - 補完は最小限（移動シーンの繋ぎなど）

**チェックリスト:**
- [ ] 構成案_確定版に従っている
- [ ] 一次データに基づいている
- [ ] 文体統一ガイドライン準拠
- [ ] セリフ洗練化ガイドライン準拠
- [ ] 時系列が正確
- [ ] キャラクターの行動・発言が正確

---

## 📝 Phase 3: 編集レビュー（編集者 ↔ 原作者）

### 目的
読み物としてのクオリティを担保し、読者に楽しんでもらえる作品に仕上げる

### 3-1. 編集者による読み物クオリティチェック

**使用エージェント:** Editor Agent（編集者エージェント）

**Claudeへの推奨プロンプト:**
```
原作者が執筆した初稿を、編集者の視点でレビューしてください。

【参照ファイル】
- 05_リプレイ/第X回_（タイトル）_初稿.md
- 05_リプレイ/_ガイドライン/編集ガイドライン.md

【レビュー観点】
1. Show vs Tell: 説明が多すぎる箇所はないか
2. テンポ・リズム: 冗長な部分、急ぎすぎる部分はないか
3. 段落構成: 読みやすい長さか、適切な改行か
4. 冗長性: 同じ情報の繰り返しがないか
5. クリフハンガー: 次回への引きは効果的か
6. 感情誘導: 読者の感情を適切に動かしているか

【出力形式】
- 章ごとの具体的フィードバック
- 改善提案（修正案を含む）
- 総合評価（S/A/B/C）
- 品質ゲート判定（合格/要修正/不合格）

【出力先】
05_リプレイ/_レビュー/第X回_編集レビュー.md
```

**編集レビューの例:**
```markdown
# 第X回 編集レビュー

## 第1章: 墓地への旅立ち

### 指摘1: Show vs Tell
**箇所:**
> センサ船長は墓荒らしの件を説明した。彼は困っているようだった。

**問題:** Tellが多く、臨場感に欠ける

**修正案:**
> センサ船長の眉間には深い皺が刻まれていた。「墓が荒らされているんだ。死者への冒涜だ」その声には、怒りと悲しみが滲んでいた。

### 指摘2: 冗長性
**箇所:**
> シャルルは正義感が強い。彼は墓荒らしを許せないと思った。そのため、すぐに行動することにした。

**問題:** 同じ内容を3文で繰り返している

**修正案:**
> 「見過ごすわけにはいかない！」シャルルの声には、揺るぎない決意が宿っていた。

## 第2章: 墓地での発見

### 指摘3: テンポ
**箇所:** 墓地への移動シーンが2段落（約400字）

**問題:** 重要でない移動シーンが長すぎる

**修正案:** 1段落（約100字）に圧縮、もしくは完全にカット

## 総合評価: B

**総評:**
- 全体的な流れは良好
- Show vs Tellのバランスに改善の余地あり
- 冗長な部分を削減すればテンポが向上
- 第3章の戦闘シーンは良い

**品質ゲート判定: 要修正**

**修正後の再レビュー:** 不要（原作者が指摘に対応すればPhase 4へ進んでOK）
```

**品質ゲート基準:**
- **S (合格):** 編集上の大きな問題なし、即Phase 4へ
- **A (合格):** 軽微な問題あり、原作者が修正後Phase 4へ
- **B (要修正):** 中程度の問題あり、原作者が修正後Phase 4へ
- **C (不合格):** 重大な問題あり、Phase 2へ戻って再執筆

### 3-2. 原作者による編集指摘への対応

**使用エージェント:** Author Agent（原作者エージェント）

**Claudeへの推奨プロンプト:**
```
編集者のフィードバックを受けて、初稿を修正してください。

【参照ファイル】
- 05_リプレイ/第X回_（タイトル）_初稿.md
- 05_リプレイ/_レビュー/第X回_編集レビュー.md

【修正方針】
- 編集者の修正案を最大限尊重
- ただし、事実関係に影響する場合は一次データを優先
- Show vs Tellのバランスを改善
- 冗長性を排除
- テンポ・リズムを調整

【出力先】
05_リプレイ/第X回_（タイトル）_編集済み.md
```

**対応時の注意点:**
1. **編集者の意図を理解する**
   - なぜその指摘がされたのか
   - 読者体験をどう改善するか

2. **事実関係は譲らない**
   - 編集案が事実と異なる場合は一次データを優先
   - その場合は代替案を提示

3. **クリエイティブな対応**
   - 編集者の修正案をそのまま使うだけでなく
   - より良い表現を模索

**チェックリスト:**
- [ ] 編集者の指摘すべてに対応した
- [ ] Show vs Tellのバランスが改善された
- [ ] 冗長性が排除された
- [ ] テンポ・リズムが向上した
- [ ] 事実関係は維持されている

---

## 🔍 Phase 4: 校正レビュー（校正者 ↔ 原作者）

### 目的
文章の正確性を担保し、誤字脱字や表記ゆれを排除する

### 4-1. 校正者による正確性チェック

**使用エージェント:** Proofreader Agent（校正者エージェント）

**Claudeへの推奨プロンプト:**
```
編集済みの原稿を、校正者の視点でチェックしてください。

【参照ファイル】
- 05_リプレイ/第X回_（タイトル）_編集済み.md
- 05_リプレイ/_ガイドライン/校正ガイドライン.md

【チェック観点】
1. 文法エラー: 助詞の誤用、述語の不一致など
2. 句読点: 読点・句点の適切な配置
3. 表現のゆらぎ: 同一語句の異なる表記
4. 漢字・ひらがなバランス: 読みやすさの確保
5. 誤字脱字: タイポの発見
6. 同音異義語の誤用: 「以外/意外」「作る/造る」など

【出力形式】
- 箇所ごとの具体的指摘
- 修正案
- 総合評価（誤り数: 0-5個/6-15個/16個以上）
- 品質ゲート判定（合格/要修正）

【出力先】
05_リプレイ/_レビュー/第X回_校正レビュー.md
```

**校正レビューの例:**
```markdown
# 第X回 校正レビュー

## 文法エラー

### エラー1
**箇所:** 「巡礼者は墓地へ向かった、そしてシャルルも続いた」
**問題:** 読点で文を繋いでいる（読点の誤用）
**修正案:** 「巡礼者は墓地へ向かった。シャルルもそれに続いた」

### エラー2
**箇所:** 「彼らが見たのは、荒らされた墓だ」
**問題:** 述語の不一致（「見たのは」に対して「だ」は不適切）
**修正案:** 「彼らが見たのは、荒らされた墓だった」

## 表現のゆらぎ

### ゆらぎ1
**箇所:** 「センサ船長」（第1章）と「センサー船長」（第3章）
**問題:** 同一人物の表記が不統一
**修正案:** 「センサ船長」に統一

### ゆらぎ2
**箇所:** 「ファルジーン市」（第1章）と「ファルジーン街」（第2章）
**問題:** 同一地名の表記が不統一
**修正案:** 「ファルジーン市」に統一

## 句読点

### 問題1
**箇所:** 「巡礼者は剣を構え敵に向かった」
**問題:** 読点がなく読みにくい
**修正案:** 「巡礼者は剣を構え、敵に向かった」

## 誤字脱字

### 誤字1
**箇所:** 「彼女の瞳には確なかな覚悟が宿っていた」
**問題:** 「確なかな」は「確かな」の誤字
**修正案:** 「彼女の瞳には確かな覚悟が宿っていた」

## 総合評価

**誤り総数:** 8個（文法2、ゆらぎ2、句読点1、誤字3）

**品質ゲート判定: 要修正**

**コメント:** 誤りは中程度。原作者が修正すればPhase 5へ進んでOK。
```

**品質ゲート基準:**
- **合格:** 誤り0-5個（軽微なもののみ）→ Phase 5へ
- **要修正:** 誤り6-15個 → 原作者が修正後Phase 5へ
- **不合格:** 誤り16個以上 → Phase 2へ戻って再執筆

### 4-2. 原作者による校正指摘への対応

**使用エージェント:** Author Agent（原作者エージェント）

**Claudeへの推奨プロンプト:**
```
校正者のフィードバックを受けて、編集済み原稿を修正してください。

【参照ファイル】
- 05_リプレイ/第X回_（タイトル）_編集済み.md
- 05_リプレイ/_レビュー/第X回_校正レビュー.md

【修正方針】
- 校正者の指摘すべてに対応
- 文法エラーを修正
- 表記ゆれを統一
- 句読点を適切に配置
- 誤字脱字を修正

【出力先】
05_リプレイ/第X回_（タイトル）_校正済み.md
```

**チェックリスト:**
- [ ] 文法エラーをすべて修正した
- [ ] 表記ゆれを統一した
- [ ] 句読点を適切に配置した
- [ ] 誤字脱字を修正した
- [ ] 漢字・ひらがなバランスを確認した

---

## ✅ Phase 5: 事実確認（検証エージェント ↔ 原作者）

### 目的
一次データとの照合により、事実誤認を排除する

### 5-1. 検証エージェントによる事実照合

**使用エージェント:** Verification Agent（検証エージェント）

**Claudeへの推奨プロンプト:**
```
校正済みの原稿を、一次データと照らし合わせて事実確認してください。

【参照ファイル】
- 05_リプレイ/第X回_（タイトル）_校正済み.md
- 04_プレイヤーログ/巡礼者_PLチョモラン/第X回目.txt
- 04_プレイヤーログ/シャルル_PLまけいぬ/第X回目_シャルル日誌.txt（あれば）
- 04_プレイヤーログ/ノクシル_PLたつや/第X回目.txt（あれば）
- 04_プレイヤーログ/_時系列メモ/第X回_時系列メモ.md

【確認項目】
1. 時系列の正確性: イベントの順序は正しいか
2. キャラクターの行動: 各PCの行動は正確か
3. 判定結果: 重要な判定（攻撃、セーヴィング・スロー等）は正確か
4. NPCの言動: NPCの発言や行動は正確か
5. 地名・人名: 固有名詞は正確か
6. 創作の有無: プレイヤーログにない出来事が含まれていないか

【出力形式】
- 矛盾箇所の指摘
- 一次データの該当箇所の引用
- 修正案
- 総合評価（矛盾: 0個/1-3個/4個以上）
- 品質ゲート判定（合格/要修正/不合格）

【出力先】
05_リプレイ/_レビュー/第X回_事実確認レビュー.md
```

**事実確認レビューの例:**
```markdown
# 第X回 事実確認レビュー

## 矛盾1: キャラクターの行動
**原稿の記述:**
> 巡礼者は《ファイアボルト》で敵を攻撃した

**一次データ（巡礼者ログ）:**
> 巡礼者は《シャター》を使用してドアを破壊した

**問題:** 使用した呪文が異なる

**修正案:** 「巡礼者は《シャター》で敵の前のドアを粉砕した」

## 矛盾2: 時系列
**原稿の記述:**
> 墓地に到着後、すぐに死体泥棒と遭遇した

**一次データ（巡礼者ログ）:**
> 墓地を調査していたら、30分後に死体泥棒を発見した

**問題:** 時系列が圧縮されすぎている

**修正案:** 「墓地を入念に調査していると、やがて不審な人影を発見した」

## 矛盾3: NPCの発言
**原稿の記述:**
> センサ船長は「急いで行ってくれ」と言った

**一次データ（巡礼者ログ）:**
> センサ船長のセリフは記録なし

**問題:** プレイヤーログにない発言を創作している

**修正案:** センサ船長の発言を削除、または「墓荒らしの件を頼む」程度の一般的な依頼に修正

## 総合評価

**矛盾総数:** 3個（行動1、時系列1、NPC発言1）

**品質ゲート判定: 要修正**

**コメント:** 中程度の矛盾あり。原作者が修正すればPhase 6へ進んでOK。
```

**品質ゲート基準:**
- **合格:** 矛盾0個 → Phase 6へ
- **要修正:** 矛盾1-3個 → 原作者が修正後Phase 6へ
- **不合格:** 矛盾4個以上 → Phase 2へ戻って再執筆

### 5-2. 原作者による事実誤認の修正

**使用エージェント:** Author Agent（原作者エージェント）

**Claudeへの推奨プロンプト:**
```
検証エージェントのフィードバックを受けて、校正済み原稿を修正してください。

【参照ファイル】
- 05_リプレイ/第X回_（タイトル）_校正済み.md
- 05_リプレイ/_レビュー/第X回_事実確認レビュー.md

【修正方針】
- 事実誤認をすべて修正
- 一次データに基づいた記述に変更
- 創作部分を削除または修正

【出力先】
05_リプレイ/第X回_（タイトル）.md（完成版）
```

**チェックリスト:**
- [ ] すべての矛盾を修正した
- [ ] 一次データと整合している
- [ ] 創作部分を削除または適切に修正した
- [ ] 時系列が正確

---

## 👤 Phase 6: ユーザー最終確認

### 目的
プロジェクトオーナー（ユーザー）による最終承認

### 6-1. ユーザーによる最終レビュー

プロジェクトオーナーが以下をチェック：

**チェックリスト:**
- [ ] 全体の流れが自然か
- [ ] キャラクターの描写が適切か
- [ ] 事実関係が正確か（プレイヤーとして違和感がないか）
- [ ] 読み物として楽しめるか
- [ ] 次回への伏線が適切か
- [ ] ガイドラインに準拠しているか

**修正が必要な場合:**
- 軽微な修正: ユーザーが直接修正してPhase 7へ
- 大きな修正: 該当Phaseへ戻る（例: 編集上の問題 → Phase 3へ）

**承認後:**
- `05_リプレイ/第X回_（タイトル）.md` が完成版として確定

---

## 👥 Phase 7: キャラクター評価更新

### 目的
各セッションでのキャラクターの成長や新しい側面を記録

### 7-1. PCキャラクター評価の更新

**使用エージェント:** Character Analysis Agent（キャラ評エージェント）

**Claudeへの推奨プロンプト:**
```
第X回のセッションを踏まえて、PCキャラクター評価を更新してください。

【対象キャラクター】
- 巡礼者
- ノクシル・グリムホルト
- シャルル・ビアトリス

【参照ファイル】
1. 05_リプレイ/第X回_（タイトル）.md（完成版リプレイ）
2. 04_プレイヤーログ/（各PLのログ）
3. 08_LLMによるキャラ評/巡礼者_キャラクター評.md
4. 08_LLMによるキャラ評/ノクシル・グリムホルト_キャラクター評.md
5. 08_LLMによるキャラ評/シャルル・ビアトリス_キャラクター評.md

【更新内容】
- 第X回での新しい側面や成長
- 他PCやNPCとの関係性の変化
- 重要な決断や行動
- 内面的な変化（シャルル日誌、ノクシルログがあれば）

【更新形式】
各ファイルの末尾に「## 第X回での変化」セクションを追加
既存の総評も必要に応じて更新
```

**チェックリスト:**
- [ ] 巡礼者の評価を更新
- [ ] ノクシルの評価を更新
- [ ] シャルルの評価を更新
- [ ] 一次データに基づいた内容

### 7-2. NPCキャラクター評価の更新・追加

**Claudeへの推奨プロンプト:**
```
第X回のセッションに登場したNPCについて、キャラクター評価を更新または新規作成してください。

【登場NPC】
- （第X回に登場したNPC名をリスト）

【参照ファイル】
1. 05_リプレイ/第X回_（タイトル）.md（完成版リプレイ）
2. 04_プレイヤーログ/（各PLのログ）
3. 08_LLMによるキャラ評/NPC_*.md（既存評価）

【更新・作成内容】
- 既存NPCの場合: 第X回での新しい情報、関係性の変化
- 新規NPCの場合: 基本情報、特徴、PCとの関係性、役割

【更新形式】
既存NPC: ファイル末尾に「## 第X回での動向」セクションを追加
新規NPC: NPC_（名前）_キャラクター評.md を新規作成
```

**チェックリスト:**
- [ ] 第X回に登場した既存NPCの評価を更新
- [ ] 新規登場NPCの評価を作成
- [ ] PCとの関係性が正確に記録されている

---

## 💾 Phase 8: 完成・公開

### 目的
完成したリプレイをGitにコミットし、Webサイトに公開する

### 8-1. GitHub Actions設定を更新

`.github/workflows/deploy-mkdocs.yml` のコピー処理に1行追加：

```yaml
- name: Copy web content from source
  run: |
    ...
    cp "05_リプレイ/第11回_墓地の秘密と死体泥棒.md" "09_Webサイト/docs/replays/session11.md"
    cp "05_リプレイ/第X回_（タイトル）.md" "09_Webサイト/docs/replays/sessionXX.md"  # ← 追加
```

### 8-2. mkdocs.yml のナビゲーションを更新

`09_Webサイト/mkdocs.yml` を編集：

```yaml
nav:
  - リプレイ本編:
    ...
    - 第11回 墓地の秘密と死体泥棒: replays/session11.md
    - 第X回 （タイトル）: replays/sessionXX.md  # ← 追加
```

### 8-3. Gitコミット＆プッシュ

```bash
git add .
git commit -m "feat: 第X回リプレイ小説「（タイトル）」を追加

- 協働型マルチエージェントワークフローに基づき作成
- 編集レビュー・校正レビュー・事実確認を実施
- PCおよびNPCキャラクター評価を更新
- Webサイトに自動反映"
git push origin main
```

### 8-4. デプロイを確認

**チェックリスト:**
- [ ] GitHubリポジトリの「Actions」タブで自動デプロイが実行中
- [ ] GitHub Actionsが正常に完了（緑色のチェックマーク）
- [ ] 2-3分後、Webサイトで第X回が表示される

---

## 🔄 Meta-Review: 複数回振り返り（3話ごと or 重要分岐点）

### 目的
複数話にまたがる一貫性を担保し、中長期的な品質を向上させる

### 実施タイミング
- 3話ごと（例: 第3回・6回・9回・12回終了後）
- キャンペーンの重要分岐点（例: 第1章完結後、第2章開始前）

### Meta-Reviewの進め方

**参加エージェント:** 全エージェント（原作者、編集者、校正者、検証者、キャラ評）

**Claudeへの推奨プロンプト:**
```
第(X-2)回～第X回の3話を振り返り、複数話にまたがる品質をチェックしてください。

【参照ファイル】
- 05_リプレイ/第(X-2)回_*.md
- 05_リプレイ/第(X-1)回_*.md
- 05_リプレイ/第X回_*.md
- 08_LLMによるキャラ評/*.md

【確認項目】
1. 伏線の一貫性: 仕込んだ伏線が適切に回収されているか
2. キャラクター描写の一貫性: キャラクターの性格・口調が一貫しているか
3. 世界観の一貫性: 地名・組織名・設定が統一されているか
4. 時系列の整合性: 複数話にまたがる時間軸に矛盾がないか
5. 文体の統一: 各回の文体が統一されているか
6. テンポの適切性: 全体として読みやすいテンポか

【出力内容】
- 各確認項目への評価
- 問題点の指摘（具体的な箇所を引用）
- 改善提案
- ガイドラインのアップデート提案

【出力先】
05_リプレイ/_MetaReview/第(X-2)～X回_MetaReview.md
```

### Meta-Reviewの結果に基づく対応

**問題が発見された場合:**
1. **伏線の未回収:** 次回以降で回収する計画を立てる
2. **キャラクター描写の不一致:** 既存リプレイを修正、またはガイドライン更新
3. **世界観の矛盾:** 既存リプレイを修正、または設定を明文化
4. **文体のゆらぎ:** 文体統一ガイドライン.mdを更新

**ガイドラインのアップデート:**
- Meta-Reviewで発見された課題に基づき、ガイドラインを更新
- 次回以降のリプレイ作成に反映

**チェックリスト:**
- [ ] 伏線の一貫性を確認
- [ ] キャラクター描写の一貫性を確認
- [ ] 世界観の一貫性を確認
- [ ] 時系列の整合性を確認
- [ ] 文体の統一を確認
- [ ] 問題点を修正またはガイドライン更新

---

## 📊 品質ゲート基準まとめ

| Phase | 担当エージェント | 合格基準 | 不合格時の対応 |
|---|---|---|---|
| **Phase 1** | 原作者 ↔ 編集者 | 編集者評価B以上 | 構成案を修正（v2作成） |
| **Phase 3** | 編集者 | 総合評価B以上 | Phase 2へ戻って再執筆（C評価の場合） |
| **Phase 4** | 校正者 | 誤り15個以下 | Phase 2へ戻って再執筆（16個以上） |
| **Phase 5** | 検証者 | 矛盾3個以下 | Phase 2へ戻って再執筆（4個以上） |
| **Phase 6** | ユーザー | ユーザー承認 | 該当Phaseへ戻る |

---

## 🎯 ワークフロー完了

お疲れ様でした！協働型マルチエージェントワークフローにより、高品質なリプレイ小説が完成しました。

**次のセッションまでに:**
- [ ] 今回のワークフローで改善点があればメモ
- [ ] ガイドラインの追加・修正が必要か検討
- [ ] Meta-Review（3話ごと）の実施タイミングを確認

---

## 📋 クイックリファレンス

### よく使うClaude プロンプト集

各Phaseの「Claudeへの推奨プロンプト」を参照してください。

### 推奨モデル一覧

- **Phase 0（時系列メモ作成）:** Haiku（データ整理）
- **Phase 0（セリフ抽出・校正）:** Haiku（ルールベース）
- **Phase 1（構成設計）:** Sonnet（原作者・編集者）
- **Phase 2（初稿執筆）:** Sonnet（原作者）
- **Phase 3（編集レビュー）:** Sonnet（編集者）
- **Phase 4（校正レビュー）:** Haiku（校正者）
- **Phase 5（事実確認）:** Haiku（検証者）
- **Phase 7（キャラ評更新）:** Sonnet（キャラ評エージェント）
- **Meta-Review:** Sonnet（全エージェント）

---

**この協働型ワークフローに従って、読み物としての面白さと正確性を両立した高品質なリプレイ小説を継続的に作成しましょう！**
